<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Check - Preventing Vulnerabilities</title>
    <link rel="stylesheet" href="../../css/styles.css">
    <link rel="stylesheet" href="../../css/components.css">
    <style>
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .question-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-lg);
            box-shadow: var(--shadow-md);
        }
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
        }
        .question-number {
            background: var(--primary);
            color: white;
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-weight: bold;
            font-size: 0.9rem;
        }
        .question-text {
            font-size: 1.1rem;
            color: var(--gray-800);
            margin-bottom: var(--space-lg);
            line-height: 1.5;
        }
        .options-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .option-item {
            margin-bottom: var(--space-sm);
        }
        .option-label {
            display: flex;
            align-items: flex-start;
            padding: var(--space-md);
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .option-label:hover {
            border-color: var(--primary);
            background: var(--gray-50);
        }
        .option-label input {
            margin-right: var(--space-md);
            margin-top: 3px;
        }
        .option-label.selected {
            border-color: var(--primary);
            background: #e7f3ff;
        }
        .option-label.correct {
            border-color: var(--success);
            background: #d4edda;
        }
        .option-label.incorrect {
            border-color: var(--error);
            background: #f8d7da;
        }
        .option-label.disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        .feedback-box {
            margin-top: var(--space-md);
            padding: var(--space-md);
            border-radius: var(--radius-md);
            display: none;
        }
        .feedback-box.correct {
            display: block;
            background: #d4edda;
            color: #155724;
        }
        .feedback-box.incorrect {
            display: block;
            background: #f8d7da;
            color: #721c24;
        }
        .quiz-progress {
            background: white;
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-xl);
            box-shadow: var(--shadow-sm);
        }
        .progress-bar {
            height: 10px;
            background: var(--gray-200);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: var(--space-sm);
        }
        .progress-fill {
            height: 100%;
            background: var(--primary);
            transition: width 0.3s ease;
        }
        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--gray-600);
        }
        .quiz-results {
            background: white;
            padding: var(--space-xl);
            border-radius: var(--radius-lg);
            text-align: center;
            margin-top: var(--space-xl);
            display: none;
        }
        .quiz-results.show {
            display: block;
        }
        .score-display {
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary);
            margin: var(--space-lg) 0;
        }
        .score-display.excellent { color: var(--success); }
        .score-display.good { color: #f0ad4e; }
        .score-display.needs-work { color: var(--error); }
        .result-message {
            font-size: 1.2rem;
            color: var(--gray-700);
            margin-bottom: var(--space-lg);
        }
        .retry-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: var(--space-md) var(--space-xl);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 1rem;
            margin-right: var(--space-sm);
        }
        .retry-btn:hover {
            background: var(--primary-dark);
        }
        .category-badge {
            font-size: 0.75rem;
            padding: 2px 8px;
            border-radius: 10px;
            background: var(--gray-100);
            color: var(--gray-600);
        }
    </style>
</head>
<body>
    <nav class="main-nav">
        <div class="nav-brand">
            <span class="logo">üêç</span>
            <span class="brand-text">Python Learning</span>
        </div>
        <ul class="nav-links">
            <li><a href="../../index.html">Home</a></li>
            <li><a href="../index.html">Topics</a></li>
            <li><a href="../../progress.html">My Progress</a></li>
        </ul>
    </nav>

    <main class="container">
        <header class="topic-header">
            <a href="index.html" class="back-link">‚Üê Back to Preventing Vulnerabilities</a>
            <h1>Knowledge Check</h1>
            <p class="subtitle">Test your understanding of security prevention methods</p>
        </header>

        <div class="quiz-progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
            </div>
            <div class="progress-text">
                <span id="answered-count">0 of 15 answered</span>
                <span id="score-count">Score: 0</span>
            </div>
        </div>

        <div class="quiz-container" id="quiz-container">
            <!-- Questions populated by JavaScript -->
        </div>

        <div class="quiz-results" id="quiz-results">
            <h2>Quiz Complete!</h2>
            <div class="score-display" id="final-score">0%</div>
            <p class="result-message" id="result-message"></p>
            <button class="retry-btn" onclick="resetQuiz()">Try Again</button>
            <a href="index.html" class="retry-btn" style="background: var(--success); text-decoration: none;">Back to Topic</a>
        </div>
    </main>

    <script src="../../js/progress.js"></script>
    <script>
        const questions = [
            {
                id: 1,
                category: 'Penetration Testing',
                question: 'What is the primary purpose of penetration testing?',
                options: [
                    'To install security software on all computers',
                    'To find vulnerabilities before malicious attackers do',
                    'To encrypt all company data',
                    'To create backup copies of important files'
                ],
                correct: 1,
                explanation: 'Penetration testing simulates real attacks to discover security weaknesses proactively. This allows organisations to fix vulnerabilities before they can be exploited by actual attackers.'
            },
            {
                id: 2,
                category: 'Penetration Testing',
                question: 'What MUST be obtained before conducting a penetration test?',
                options: [
                    'Anti-malware software',
                    'A faster internet connection',
                    'Written authorization from the system owner',
                    'A list of all employee passwords'
                ],
                correct: 2,
                explanation: 'Written authorization is legally required. Without it, penetration testing is the same as illegal hacking. The authorization document defines the scope and rules of the test.'
            },
            {
                id: 3,
                category: 'Anti-Malware',
                question: 'How does anti-malware software primarily detect known viruses?',
                options: [
                    'By checking the file size',
                    'By comparing files against a database of known malware signatures',
                    'By asking the user if the file is safe',
                    'By encrypting all files'
                ],
                correct: 1,
                explanation: 'Signature-based detection compares files against a database of known malware patterns (signatures). This is why keeping anti-malware updated is essential - new signatures are added constantly.'
            },
            {
                id: 4,
                category: 'Anti-Malware',
                question: 'Why must anti-malware signature databases be updated regularly?',
                options: [
                    'To make the software run faster',
                    'To change the user interface',
                    'To detect newly created malware that didn\'t exist before',
                    'To reduce the software\'s file size'
                ],
                correct: 2,
                explanation: 'Thousands of new malware variants are created daily. Without updated signatures, anti-malware cannot detect recent threats, leaving systems vulnerable to the latest attacks.'
            },
            {
                id: 5,
                category: 'Firewalls',
                question: 'What is the recommended default policy for a firewall?',
                options: [
                    'Allow all traffic, then block specific threats',
                    'Deny all traffic, then allow specific needed traffic',
                    'Allow all internal traffic only',
                    'Block nothing to avoid disrupting business'
                ],
                correct: 1,
                explanation: 'Default deny is more secure: block everything, then explicitly whitelist what\'s needed. This ensures unknown or unexpected traffic is blocked, rather than hoping you\'ve blocked all threats.'
            },
            {
                id: 6,
                category: 'Firewalls',
                question: 'Against which threat are firewalls LEAST effective?',
                options: [
                    'Unauthorised external connection attempts',
                    'Phishing emails that trick users',
                    'Network worms spreading between computers',
                    'Port scanning attacks'
                ],
                correct: 1,
                explanation: 'Firewalls cannot inspect email content for social engineering - emails arrive through allowed ports (25, 587). User training is more effective against phishing than firewalls.'
            },
            {
                id: 7,
                category: 'User Access Levels',
                question: 'What is the "principle of least privilege"?',
                options: [
                    'Giving all users administrator access for convenience',
                    'Users should have only the minimum permissions needed for their job',
                    'The IT department should have fewer privileges than users',
                    'New employees should have no access to any systems'
                ],
                correct: 1,
                explanation: 'Least privilege means each user gets only what they need - nothing more. This limits damage from compromised accounts and prevents accidental access to sensitive data.'
            },
            {
                id: 8,
                category: 'User Access Levels',
                question: 'A receptionist\'s account is compromised by ransomware. Why might user access levels limit the damage?',
                options: [
                    'The ransomware will be automatically deleted',
                    'The receptionist\'s limited permissions restrict what the ransomware can encrypt',
                    'User access levels encrypt all files automatically',
                    'The firewall will detect the ransomware'
                ],
                correct: 1,
                explanation: 'Malware runs with the user\'s permissions. If the receptionist can only access appointment files, the ransomware can only encrypt those files - not financial records or patient data they couldn\'t access.'
            },
            {
                id: 9,
                category: 'Passwords',
                question: 'Which password is MOST resistant to brute-force attacks?',
                options: [
                    'Password123!',
                    'JohnSmith1985',
                    'Kx9#mP2$nL7@qR4',
                    'qwertyuiop'
                ],
                correct: 2,
                explanation: 'Kx9#mP2$nL7@qR4 is random with mixed case, numbers, and symbols. Common passwords (Password123), names/dates (JohnSmith1985), and keyboard patterns (qwerty) are tried early in brute-force attacks.'
            },
            {
                id: 10,
                category: 'Passwords',
                question: 'What is the main security benefit of using different passwords for each account?',
                options: [
                    'It makes passwords easier to remember',
                    'If one account is breached, others remain protected',
                    'It speeds up the login process',
                    'It makes brute-force attacks faster'
                ],
                correct: 1,
                explanation: 'Using unique passwords prevents credential stuffing - where attackers use credentials stolen from one breach to access other accounts. One breach doesn\'t compromise everything.'
            },
            {
                id: 11,
                category: 'Encryption',
                question: 'What does encryption protect against if a laptop is stolen?',
                options: [
                    'The laptop being resold',
                    'The thief accessing the data stored on it',
                    'Future malware infections',
                    'The laptop\'s battery draining'
                ],
                correct: 1,
                explanation: 'Full disk encryption means data is unreadable without the encryption key/password. Even with physical access to the hard drive, the thief cannot read the encrypted data.'
            },
            {
                id: 12,
                category: 'Encryption',
                question: 'Where should encryption keys be stored?',
                options: [
                    'In the same location as the encrypted data',
                    'In a separate, secure location from the encrypted data',
                    'Written on a sticky note attached to the computer',
                    'Shared publicly so everyone can access the data'
                ],
                correct: 1,
                explanation: 'Keys must be stored separately from encrypted data. If an attacker gets both the encrypted data AND the key from the same place, the encryption provides no protection.'
            },
            {
                id: 13,
                category: 'Physical Security',
                question: 'Why is physical security considered the foundation of all security measures?',
                options: [
                    'It\'s the cheapest security measure to implement',
                    'If attackers have physical access, they can bypass most other security',
                    'It only protects against hardware theft',
                    'Software security is more important'
                ],
                correct: 1,
                explanation: 'With physical access, attackers can remove hard drives, install keyloggers, boot from USB, or simply steal equipment. Software security assumes physical security is already in place.'
            },
            {
                id: 14,
                category: 'Physical Security',
                question: 'What is a key advantage of electronic access control (key cards) over traditional keys?',
                options: [
                    'It\'s impossible to copy a key card',
                    'It creates an audit trail showing who entered and when',
                    'Key cards never need batteries',
                    'Traditional keys provide better security'
                ],
                correct: 1,
                explanation: 'Electronic access control logs every access attempt with timestamps and user IDs. This audit trail is valuable for investigating incidents and traditional keys don\'t provide this.'
            },
            {
                id: 15,
                category: 'Defence in Depth',
                question: 'What is "defence in depth" in security?',
                options: [
                    'Using only one very strong security measure',
                    'Using multiple layers of different security measures',
                    'Placing all security equipment deep underground',
                    'Only protecting the most important systems'
                ],
                correct: 1,
                explanation: 'Defence in depth uses multiple overlapping security layers. If one measure fails (e.g., firewall bypassed), others still provide protection (e.g., encryption, access controls, anti-malware).'
            }
        ];

        let userAnswers = {};
        let score = 0;

        function initQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';

            questions.forEach((q, index) => {
                const card = createQuestionCard(q, index);
                container.appendChild(card);
            });

            updateProgress();
        }

        function createQuestionCard(question, index) {
            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `question-${index}`;

            card.innerHTML = `
                <div class="question-header">
                    <span class="question-number">Question ${question.id}</span>
                    <span class="category-badge">${question.category}</span>
                </div>
                <p class="question-text">${question.question}</p>
                <ul class="options-list">
                    ${question.options.map((option, i) => `
                        <li class="option-item">
                            <label class="option-label" id="option-${index}-${i}">
                                <input type="radio" name="question-${index}" value="${i}" onchange="selectAnswer(${index}, ${i})">
                                <span>${option}</span>
                            </label>
                        </li>
                    `).join('')}
                </ul>
                <div class="feedback-box" id="feedback-${index}">
                    <strong id="feedback-title-${index}"></strong>
                    <p id="feedback-text-${index}"></p>
                </div>
            `;

            return card;
        }

        function selectAnswer(questionIndex, optionIndex) {
            const question = questions[questionIndex];
            const wasAnswered = userAnswers[questionIndex] !== undefined;

            // Store answer
            userAnswers[questionIndex] = optionIndex;

            // Disable all options for this question
            const options = document.querySelectorAll(`input[name="question-${questionIndex}"]`);
            options.forEach(opt => {
                opt.disabled = true;
                opt.closest('.option-label').classList.add('disabled');
            });

            // Mark selected option
            const selectedLabel = document.getElementById(`option-${questionIndex}-${optionIndex}`);
            selectedLabel.classList.add('selected');

            // Show correct/incorrect
            const isCorrect = optionIndex === question.correct;

            if (isCorrect) {
                selectedLabel.classList.add('correct');
                if (!wasAnswered) score++;
            } else {
                selectedLabel.classList.add('incorrect');
                // Show correct answer
                const correctLabel = document.getElementById(`option-${questionIndex}-${question.correct}`);
                correctLabel.classList.add('correct');
            }

            // Show feedback
            const feedbackBox = document.getElementById(`feedback-${questionIndex}`);
            const feedbackTitle = document.getElementById(`feedback-title-${questionIndex}`);
            const feedbackText = document.getElementById(`feedback-text-${questionIndex}`);

            feedbackBox.className = `feedback-box ${isCorrect ? 'correct' : 'incorrect'}`;
            feedbackTitle.textContent = isCorrect ? 'Correct!' : 'Incorrect';
            feedbackText.textContent = question.explanation;

            updateProgress();
            checkCompletion();
        }

        function updateProgress() {
            const answered = Object.keys(userAnswers).length;
            const total = questions.length;
            const percentage = (answered / total) * 100;

            document.getElementById('progress-fill').style.width = `${percentage}%`;
            document.getElementById('answered-count').textContent = `${answered} of ${total} answered`;
            document.getElementById('score-count').textContent = `Score: ${score}`;
        }

        function checkCompletion() {
            if (Object.keys(userAnswers).length === questions.length) {
                setTimeout(showResults, 500);
            }
        }

        function showResults() {
            const percentage = Math.round((score / questions.length) * 100);
            const resultsDiv = document.getElementById('quiz-results');
            const scoreDisplay = document.getElementById('final-score');
            const resultMessage = document.getElementById('result-message');

            scoreDisplay.textContent = `${percentage}%`;
            scoreDisplay.className = 'score-display';

            if (percentage >= 80) {
                scoreDisplay.classList.add('excellent');
                resultMessage.textContent = `Excellent! You scored ${score} out of ${questions.length}. You have a strong understanding of security prevention methods!`;
            } else if (percentage >= 60) {
                scoreDisplay.classList.add('good');
                resultMessage.textContent = `Good job! You scored ${score} out of ${questions.length}. Review the explanations for questions you missed.`;
            } else {
                scoreDisplay.classList.add('needs-work');
                resultMessage.textContent = `You scored ${score} out of ${questions.length}. Consider reviewing the topic content and trying again.`;
            }

            resultsDiv.classList.add('show');

            // Save progress
            Progress.saveActivity('prevention-quiz', 'completed', percentage);

            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function resetQuiz() {
            userAnswers = {};
            score = 0;
            document.getElementById('quiz-results').classList.remove('show');
            initQuiz();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initQuiz();
            Progress.startActivity('prevention-quiz', 'quiz');
        });
    </script>
</body>
</html>
